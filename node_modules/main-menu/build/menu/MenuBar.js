'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _underscore = require('underscore');

var _underscore2 = _interopRequireDefault(_underscore);

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _reactDom = require('react-dom');

var _reactDom2 = _interopRequireDefault(_reactDom);

var _reactEs6Component = require('react-es6-component');

var _reactEs6Component2 = _interopRequireDefault(_reactEs6Component);

var MenuBar = (function (_Component) {
  _inherits(MenuBar, _Component);

  function MenuBar() {
    _classCallCheck(this, MenuBar);

    _get(Object.getPrototypeOf(MenuBar.prototype), 'constructor', this).apply(this, arguments);
  }

  _createClass(MenuBar, [{
    key: 'render',
    value: function render() {
      var children = _react2['default'].Children.map(this.props.children, this._listenToMenuItem);
      return _react2['default'].createElement(
        'div',
        { className: 'menu-bar' },
        children
      );
    }
  }, {
    key: '_listenToMenuItem',
    value: function _listenToMenuItem(element, i) {
      var name = 'menuItem' + i;
      return _react2['default'].cloneElement(element, {
        ref: name,
        onClose: _underscore2['default'].partial(this._onMenuClose, name),
        onMouseOver: _underscore2['default'].partial(this._onMouseOver, i)
      });
    }
  }, {
    key: '_onMouseOver',
    value: function _onMouseOver(index, event) {
      var menuItem = this.refs['menuItem' + index];
      if (this._anyIsOpen()) {
        if (_reactDom2['default'].findDOMNode(menuItem).contains(event.target) && !menuItem.isOpen()) {
          this._closeAll();
          menuItem.open();
        }
      }
    }
  }, {
    key: '_closeAll',
    value: function _closeAll() {
      for (var i = 0; i < this.props.children.length; i++) {
        var menuItem = this.refs['menuItem' + i];
        if (menuItem.isOpen()) {
          menuItem.close();
        }
      }
    }
  }, {
    key: '_anyIsOpen',
    value: function _anyIsOpen() {
      for (var i = 0; i < this.props.children.length; i++) {
        var menuItem = this.refs['menuItem' + i];
        if (menuItem.isOpen()) {
          return true;
        }
      }
      return false;
    }
  }, {
    key: '_onMenuClose',
    value: function _onMenuClose(name) {
      var menuItem = this.refs[name];
      menuItem.close();
    }
  }]);

  return MenuBar;
})(_reactEs6Component2['default']);

exports['default'] = MenuBar;
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1lbnUvTWVudUJhci5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OzswQkFBYyxZQUFZOzs7O3FCQUNSLE9BQU87Ozs7d0JBQ0osV0FBVzs7OztpQ0FDVixxQkFBcUI7Ozs7SUFFdEIsT0FBTztZQUFQLE9BQU87O1dBQVAsT0FBTzswQkFBUCxPQUFPOzsrQkFBUCxPQUFPOzs7ZUFBUCxPQUFPOztXQUVwQixrQkFBRTtBQUNOLFVBQU0sUUFBUSxHQUFHLG1CQUFNLFFBQVEsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUM7QUFDakYsYUFDRTs7VUFBSyxTQUFTLEVBQUMsVUFBVTtRQUN0QixRQUFRO09BQ0wsQ0FDTjtLQUNIOzs7V0FFZ0IsMkJBQUMsT0FBTyxFQUFFLENBQUMsRUFBQztBQUMzQixVQUFNLElBQUksZ0JBQWMsQ0FBQyxBQUFFLENBQUM7QUFDNUIsYUFBTyxtQkFBTSxZQUFZLENBQUMsT0FBTyxFQUFFO0FBQ2pDLFdBQUcsRUFBRSxJQUFJO0FBQ1QsZUFBTyxFQUFFLHdCQUFFLE9BQU8sQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQztBQUMzQyxtQkFBVyxFQUFFLHdCQUFFLE9BQU8sQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FBQztPQUM3QyxDQUFDLENBQUM7S0FDSjs7O1dBRVcsc0JBQUMsS0FBSyxFQUFFLEtBQUssRUFBQztBQUN4QixVQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUMsQ0FBQztBQUMvQyxVQUFHLElBQUksQ0FBQyxVQUFVLEVBQUUsRUFBQztBQUNuQixZQUFHLHNCQUFTLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxFQUFDO0FBQzdFLGNBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztBQUNqQixrQkFBUSxDQUFDLElBQUksRUFBRSxDQUFDO1NBQ2pCO09BQ0Y7S0FDRjs7O1dBRVEscUJBQUU7QUFDVCxXQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFDO0FBQ2pELFlBQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxHQUFHLENBQUMsQ0FBQyxDQUFDO0FBQzNDLFlBQUcsUUFBUSxDQUFDLE1BQU0sRUFBRSxFQUFDO0FBQ25CLGtCQUFRLENBQUMsS0FBSyxFQUFFLENBQUM7U0FDbEI7T0FDRjtLQUNGOzs7V0FFUyxzQkFBRTtBQUNWLFdBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUM7QUFDakQsWUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDM0MsWUFBRyxRQUFRLENBQUMsTUFBTSxFQUFFLEVBQUM7QUFDbkIsaUJBQU8sSUFBSSxDQUFDO1NBQ2I7T0FDRjtBQUNELGFBQU8sS0FBSyxDQUFDO0tBQ2Q7OztXQUVXLHNCQUFDLElBQUksRUFBQztBQUNoQixVQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ2pDLGNBQVEsQ0FBQyxLQUFLLEVBQUUsQ0FBQztLQUNsQjs7O1NBcERrQixPQUFPOzs7cUJBQVAsT0FBTyIsImZpbGUiOiJtZW51L01lbnVCYXIuanN4Iiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF8gZnJvbSAndW5kZXJzY29yZSc7XHJcbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCBSZWFjdERPTSBmcm9tICdyZWFjdC1kb20nO1xyXG5pbXBvcnQgQ29tcG9uZW50IGZyb20gJ3JlYWN0LWVzNi1jb21wb25lbnQnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWVudUJhciBleHRlbmRzIENvbXBvbmVudCB7XHJcblxyXG4gIHJlbmRlcigpe1xyXG4gICAgY29uc3QgY2hpbGRyZW4gPSBSZWFjdC5DaGlsZHJlbi5tYXAodGhpcy5wcm9wcy5jaGlsZHJlbiwgdGhpcy5fbGlzdGVuVG9NZW51SXRlbSk7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1lbnUtYmFyXCI+XHJcbiAgICAgICAge2NoaWxkcmVufVxyXG4gICAgICA8L2Rpdj5cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfbGlzdGVuVG9NZW51SXRlbShlbGVtZW50LCBpKXtcclxuICAgIGNvbnN0IG5hbWUgPSBgbWVudUl0ZW0ke2l9YDtcclxuICAgIHJldHVybiBSZWFjdC5jbG9uZUVsZW1lbnQoZWxlbWVudCwge1xyXG4gICAgICByZWY6IG5hbWUsXHJcbiAgICAgIG9uQ2xvc2U6IF8ucGFydGlhbCh0aGlzLl9vbk1lbnVDbG9zZSwgbmFtZSksXHJcbiAgICAgIG9uTW91c2VPdmVyOiBfLnBhcnRpYWwodGhpcy5fb25Nb3VzZU92ZXIsIGkpXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9vbk1vdXNlT3ZlcihpbmRleCwgZXZlbnQpe1xyXG4gICAgY29uc3QgbWVudUl0ZW0gPSB0aGlzLnJlZnNbJ21lbnVJdGVtJyArIGluZGV4XTtcclxuICAgIGlmKHRoaXMuX2FueUlzT3BlbigpKXtcclxuICAgICAgaWYoUmVhY3RET00uZmluZERPTU5vZGUobWVudUl0ZW0pLmNvbnRhaW5zKGV2ZW50LnRhcmdldCkgJiYgIW1lbnVJdGVtLmlzT3BlbigpKXtcclxuICAgICAgICB0aGlzLl9jbG9zZUFsbCgpO1xyXG4gICAgICAgIG1lbnVJdGVtLm9wZW4oKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2Nsb3NlQWxsKCl7XHJcbiAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5wcm9wcy5jaGlsZHJlbi5sZW5ndGg7IGkrKyl7XHJcbiAgICAgIGNvbnN0IG1lbnVJdGVtID0gdGhpcy5yZWZzWydtZW51SXRlbScgKyBpXTtcclxuICAgICAgaWYobWVudUl0ZW0uaXNPcGVuKCkpe1xyXG4gICAgICAgIG1lbnVJdGVtLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9hbnlJc09wZW4oKXtcclxuICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLnByb3BzLmNoaWxkcmVuLmxlbmd0aDsgaSsrKXtcclxuICAgICAgY29uc3QgbWVudUl0ZW0gPSB0aGlzLnJlZnNbJ21lbnVJdGVtJyArIGldO1xyXG4gICAgICBpZihtZW51SXRlbS5pc09wZW4oKSl7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIF9vbk1lbnVDbG9zZShuYW1lKXtcclxuICAgIGNvbnN0IG1lbnVJdGVtID0gdGhpcy5yZWZzW25hbWVdO1xyXG4gICAgbWVudUl0ZW0uY2xvc2UoKTtcclxuICB9XHJcbn1cclxuIl19